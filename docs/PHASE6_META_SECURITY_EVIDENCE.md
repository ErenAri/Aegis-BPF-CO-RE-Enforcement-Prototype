# Phase 6 Meta-Security Evidence

This page captures evidence for **Phase 6: Agent meta-security** from
`docs/MATURITY_PROGRAM.md`.

## Gate-to-evidence mapping

| Phase-6 gate | Evidence |
|---|---|
| Signing lifecycle tests cover add/rotate/revoke + anti-rollback | `KeyLifecycleTest.RotateAndRevokeTrustedSigningKeys`, `CmdPolicyApplySignedTest.RejectsRollbackBundleVersion` |
| Release pipeline emits SBOM + signed artifacts + provenance attestations | `.github/workflows/release.yml` (`Generate SBOM`, `Sign artifacts with Cosign`, `actions/attest-build-provenance`, `Validate capability contract`) |
| Capability requirements minimized, documented, validated | `SECURITY.md` minimum-capability table, `packaging/systemd/aegisbpf.service` `CapabilityBoundingSet`/`AmbientCapabilities`, and `scripts/validate_capability_contract.py` |

## Artifact contract

The key-rotation drill workflow must emit and publish:

- `artifacts/meta-security/key-rotation-summary.json`
  - generated by `scripts/key_rotation_drill.sh` via `SUMMARY_OUT`
  - includes: `suite`, `status`, `ctest_regex`, `timestamp_utc`
- `artifacts/meta-security/capability-contract-report.md`
  - generated by `scripts/validate_capability_contract.py`
  - proves documented capabilities match systemd capability bounds

These artifacts are uploaded by `.github/workflows/key-rotation-drill.yml`
(`Upload meta-security drill artifacts`).

## CI evidence links

- Release pipeline:
  - https://github.com/ErenAri/Aegis-BPF-CO-RE-Enforcement-Prototype/actions/workflows/release.yml
- Security pipeline:
  - https://github.com/ErenAri/Aegis-BPF-CO-RE-Enforcement-Prototype/actions/workflows/security.yml
- Key-rotation drill:
  - https://github.com/ErenAri/Aegis-BPF-CO-RE-Enforcement-Prototype/actions/workflows/key-rotation-drill.yml
